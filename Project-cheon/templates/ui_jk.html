<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    <link rel="stylesheet" href="../static/css/ui_jk.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <div class="logo-icon"></div>
            <h2>Logo Here</h2>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="#" class="nav-link active">
                    <span class="nav-icon">🏠</span>
                    Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <span class="nav-icon">💬</span>
                    Messages
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <span class="nav-icon">📊</span>
                    Report
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <span class="nav-icon">⚙️</span>
                    Setting
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <span class="nav-icon">🔒</span>
                    Privacy
                </a>
            </li>
        </ul>

        <div class="bottom-controls">
            <div class="toggle-control">
                <span>🌙 Light Mode</span>
                <div class="toggle-switch"></div>
            </div>
            <a href="#" class="withdraw-btn">
                <span>💰 Withdraw</span>
            </a>
            <button class="logout-btn">📤 Logout</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <h1 class="page-title">Analytics</h1>
            <div class="header-controls">
                <div class="date-selector">14 Feb 2019 - 15 Feb 2019</div>
                <button class="notification-btn">🔔</button>
                <div class="profile-btn">YN</div>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="weather-card">
                <div class="weather-header">
                    <div class="weather-title">Lorem</div>
                    <div class="weather-stat">250</div>
                </div>

                <div class="metric-cards">
                    <div class="metric-card one">
                        <div style="width: 8px; height: 8px; background: #2196f3; border-radius: 50%; margin: 0 auto 5px;"></div>
                    </div>
                    <div class="metric-card two">
                        <div style="width: 8px; height: 8px; background: #2196f3; border-radius: 50%; margin: 0 auto 5px;"></div>
                    </div>
                    <div class="metric-card blue">
                        <div style="width: 8px; height: 8px; background: #2196f3; border-radius: 50%; margin: 0 auto 5px;"></div>
                    </div>
                    <div class="metric-card orange">
                        <div style="width: 8px; height: 8px; background: #ff9800; border-radius: 50%; margin: 0 auto 5px;"></div>
                    </div>
                    <div class="metric-card pink">
                        <div style="width: 8px; height: 8px; background: #e91e63; border-radius: 50%; margin: 0 auto 5px;"></div>
                    </div>
                </div>
            </div>

            <div class="chart-bars">
                <div class="chart-box">
                <h2>작물별 환경 평균 그래프</h2>
                <canvas id="barChart" width="700" height="350"></canvas>
                </div>
            </div>

            <div class="ranking-table-container">
                <div class="ranking-table-header">
                    <h2>가격 데이터</h2>
                    <button class="ranking-select-btn">SELECT</button>
                </div>
                <div class="ranking-table-wrapper">
                    <table class="ranking-table">
                    <thead>
                        <tr>
                        <th data-column="rank">번호</th>
                        <th data-column="name">작물명</th>
                        <th data-column="price">소매가격</th>
                        <th data-column="change">등락률</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in ranking_data %}
                        <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ row.itemname }} ({{ row.unit }})</td>
                        <td>{{ row.price }}</td>
                        <td>{{ row.weekprice }}%</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                    </table>
                </div>
            </div>
        </div>


    </div>

    <script>
        // 작물별 환경 평균 그래프
        const ctx = document.getElementById('barChart').getContext('2d');
        const barChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: {{ compare_dict.labels | tojson }},
            datasets: [
            {
                label: '온도_내부 (°C)',
                backgroundColor: '#FF6B6B',
                data: {{ compare_dict.temp | tojson }}
            },
            {
                label: '상대습도_내부 (%)',
                backgroundColor: '#4ECDC4',
                data: {{ compare_dict.humid | tojson }}
            },
            {
                label: '일사량_외부 (W/m²)',
                backgroundColor: '#FFE66D',
                data: {{ compare_dict.solar | tojson }}
            }
            ]
        },
        options: {
        plugins: {
            legend: {
            display: true,
            position: 'top',
            align: 'end',
            labels: {
                padding: 20,
                boxWidth: 20,
            }
            }
        },
        layout: {
            padding: {
            top: 20,    // 전체 차트 내 여백 조정
            right: 30,  // 오른쪽 여백 늘려서 범례가 더 오른쪽에 위치하도록
            left: 10,
            bottom: 10
            }
        }
        }
        });
    </script>

    <script>
        // 모든 nav-link 요소 선택
        const navLinks = document.querySelectorAll('.nav-link');

        // 각 링크에 클릭 이벤트 걸기
        navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault(); // 링크 이동 막기

            // 모든 링크에서 active 제거
            navLinks.forEach(item => item.classList.remove('active'));

            // 클릭한 링크에만 active 추가
            this.classList.add('active');
        });
        });

        const toggle = document.querySelector('.toggle-switch');

        toggle.addEventListener('click', () => {
        toggle.classList.toggle('active');
        });
    </script>
</body>
</html>